{% import "bootstrap/wtf.html" as wtf %}
{% extends "base.html" %}


{% block head %}
  <style>
    .DeepPink { color: DeepPink; }
    .Lime { color: Lime; }
    .Turquoise { color: Turquoise; }
    .Indigo { color: Indigo; }
    .Blue { color: Blue; }
    .Gold { color: Gold; }
  </style>
{% endblock %}


{% block form %}
  <form method="POST">
  {{ form.csrf_token }}
  <div class="form-group">
    <div class="form-row">

      <div class="col">
        <select class="selectpicker" data-live-search="true" data-live-search-normalize="true" data-width="90px" data-style='' data-style-base='form-control form-control-sm' id="language1" name="language1">
          {% for language in languageChoices %}
            <option value="{{ language[0] }}">{{ language[1] }}</option>
          {% endfor %}
        </select>
      </div>

      <div class="col">
        <select class="selectpicker" data-live-search="true" data-live-search-normalize="true" data-width="90px" data-style='' data-style-base='form-control form-control-sm' id="translation1" name="translation1">
        </select>
      </div>

    </div>
  </div>
  <div class="form-group">
    {{ wtf.form_field(form.search, class="form-control form-control-sm") }}
  </div>
  <div class="form-group">
    {{ wtf.form_field(form.caseSensitive, class="form-control form-control-sm") }}
    {{ wtf.form_field(form.searchOptions, class="form-control form-control-sm") }}
  </div>
  <div class="form-group">
    {{ wtf.form_field(form.submit, class="form-control form-control-sm") }}
  </div>

  <script src="{{url_for('static', filename='scripts.js')}}"></script>
  <script>

    lang_select.onchange = function() {
        populateList(lang_select, tran_select, 'translation1', lang_select.value);
    };

    {% if language_id is defined %}
        $('#language1').selectpicker('val', {{ language_id }});
        populateList(lang_select, tran_select, 'translation1', lang_select.value, [{{ translation_id }}]);
        $('#search').attr('value', {{ searchItem|tojson }});
        $("#caseSensitive").attr('checked', "{{ case }}".toLowerCase());
        $('input[value="{{ searchOption }}"]').attr('checked', 'checked');
    {% else %}
        populateList(lang_select, tran_select, 'translation1');
    {% endif %}

  </script>

{% endblock %}

{% block form2 %}
<nav class="navbar navbar-expand-lg sticky-top bg-dark shadow text-light">
<form method="POST" class="form-inline">
  {{ sortForm.csrf_token }}

<div class="form-row justify-content-between">

<div class="col-inline align-text-bottom">
    <p>Sorting options: </p>
</div>

<div class="col-inline">
    <label for="option1">1</label>
    <select class="selectpicker" data-style='' data-style-base='form-control form-control-sm' data-width="auto" id="option1" name="option1">
      {% for choice in choices %}
        <option value="{{ choice[0] }}">{{ choice[1] }}</option>
      {% endfor %}
    </select>
</div>

<div class="col-inline">
    <label for="option2">2</label>
    <select class="selectpicker" data-style='' data-style-base='form-control form-control-sm' data-width="auto" id="option2" name="option2">
      {% for choice in choices %}
        <option value="{{ choice[0] }}">{{ choice[1] }}</option>
      {% endfor %}
    </select>
</div>

    <div class="col-inline">
    <label for="option3">3</label>
    <select class="selectpicker" data-style='' data-style-base='form-control form-control-sm' data-width="auto" id="option3" name="option3">
      {% for choice in choices %}
        <option value="{{ choice[0] }}">{{ choice[1] }}</option>
      {% endfor %}
    </select>
</div>

    <div class="col-inline">
    <label for="option4">4</label>
    <select class="selectpicker" data-style='' data-style-base='form-control form-control-sm' data-width="auto" id="option4" name="option4">
      {% for choice in choices %}
        <option value="{{ choice[0] }}">{{ choice[1] }}</option>
      {% endfor %}
    </select>
</div>

    <div class="col-inline">
    <label for="option5">5</label>
    <select class="selectpicker" data-style='' data-style-base='form-control form-control-sm' data-width="auto" id="option5" name="option5">
      {% for choice in choices %}
        <option value="{{ choice[0] }}">{{ choice[1] }}</option>
      {% endfor %}
    </select>
</div>

    <div class="col-inline">
    <label for="option6">6</label>
    <select class="selectpicker" data-style='' data-style-base='form-control form-control-sm' data-width="auto" id="option6" name="option6">
      {% for choice in choices %}
        <option value="{{ choice[0] }}">{{ choice[1] }}</option>
      {% endfor %}
    </select>
</div>

    <div class="col">
    <div style="width=50%">
      {{ wtf.form_field(sortForm.sort, class="form-control form-control-sm") }}
    </div>

    <div class="form-group">
      {{ wtf.form_field(form.option8, class="form-control form-control-sm my-select") }}
    </div>
</div>
</div>
</form>
</nav>

  <script>
    $('.my-select').addClass('selectpicker');
    $('.my-select').attr('data-width', 'auto');
    $('.my-select').attr('data-style', '');

    var sortSubmit = document.getElementById('sort');
    sortSubmit.onclick = function() {
        var options = [];
        for (var i = 0; i < 6; i++) {
            options.push(document.getElementById(`option${i+1}`).value);
        };
    };
  </script>
{% endblock %}

{% block content %}

  {% if errorMessage %}
  <h1>{{ errorMessage[:5] }}</h1>
  <h3>{{ errorMessage[6:] }}</h3>
  {% endif %}

  {% if concLength is not defined %}
    {% set concLength = None %}
  {% elif concLength == 0 %}
  <h1>Sorry</h1>
  <h3>Nothing found. Please, try to change your search criteria.</h3>
  {% else %}
    <div class="row justify-content-center">
    {% if concLength == 1 %}
      <p><b>Found: 1 result / {{ pages }} page</b></p>
    {% elif concLength > 1 and pages == 1 %}
      <p><b>Found: {{ concLength }} results / {{ pages }} page</b></p>
    {% else %}
      <p><b>Found: {{ concLength }} results / {{ pages }} pages</b></p>
    {% endif %}
    </div>

    <nav class="table-responsive mb-2s">
      <ul class="pagination mb-0 justify-content-center">
        <li class="page-item disabled">
         <a class="page-link" tabindex="-1" aria-disabled="true" id="first1">First</a>
        </li>

        <li class="page-item disabled">
         <a class="page-link" tabindex="-1" aria-disabled="true" id="previous1">Previous</a>
        </li>

        <div class="input-group mb-3" style="width: 60px">
          <input type="text" class="form-control" value="1" aria-describedby="basic-addon1" id="pageNumber1">
        </div>

        <li class="page-item">
          <a class="page-link" id="next1">Next</a>
        </li>

        <li class="page-item">
         <a class="page-link" tabindex="-1" aria-disabled="true" id="last1">Last</a>
        </li>
      </ul>
    </nav>

    <div id="renderPagConc">
    </div>

    <div class="row justify-content-center">
    {% if concLength == 1 %}
      <p><b>Found: 1 result / {{ pages }} page</b></p>
    {% elif concLength > 1 and pages == 1 %}
      <p><b>Found: {{ concLength }} results / {{ pages }} page</b></p>
    {% else %}
      <p><b>Found: {{ concLength }} results / {{ pages }} pages</b></p>
    {% endif %}
    </div>

    <nav class="table-responsive mb-2s">
      <ul class="pagination mb-0 justify-content-center">
        <li class="page-item disabled">
         <a class="page-link" tabindex="-1" aria-disabled="true" id="first2">First</a>
        </li>

        <li class="page-item disabled">
         <a class="page-link" tabindex="-1" aria-disabled="true" id="previous2">Previous</a>
        </li>

        <div class="input-group mb-3" style="width: 60px">
          <input type="text" class="form-control" value="1" aria-describedby="basic-addon1" id="pageNumber2">
        </div>

        <li class="page-item">
          <a class="page-link" id="next2">Next</a>
        </li>

        <li class="page-item">
         <a class="page-link" tabindex="-1" aria-disabled="true" id="last2">Last</a>
        </li>
      </ul>
    </nav>

    <script>

        var link = `/browse/1/{{ language_id }}/{{ translation_id }}`;

        renderPagConc({{ conc|tojson }}, 1, link);

        var pageValue = parseInt(pageNumber1.value);

        pageNumber1.onchange = function() {
              pageValue = parseInt(pageNumber1.value);
                renderPagConc({{ conc|tojson }}, pageValue, link);
        };

        pageNumber2.onchange = function() {
              pageValue = parseInt(pageNumber2.value);
                renderPagConc({{ conc|tojson }}, pageValue, link);
        };

        previous1.onclick = function() {
            pageValue -= 1;
            renderPagConc({{ conc|tojson }}, pageValue, link);
        };

        previous2.onclick = function() {
            pageValue -= 1;
            renderPagConc({{ conc|tojson }}, pageValue, link);
        };

        next1.onclick = function() {
            pageValue += 1;
            renderPagConc({{ conc|tojson }}, pageValue, link);
        };

        next2.onclick = function() {
            pageValue += 1;
            renderPagConc({{ conc|tojson }}, pageValue, link);
        };

        first1.onclick = function() {
            pageValue = 1;
            renderPagConc({{ conc|tojson }}, pageValue, link);
        };

        first2.onclick = function() {
            pageValue = 1;
            renderPagConc({{ conc|tojson }}, pageValue, link);
        };

        last1.onclick = function() {
            pageValue = Object.keys({{ conc|tojson }}).length;
            renderPagConc({{ conc|tojson }}, pageValue, link);
        };

        last2.onclick = function() {
            pageValue = Object.keys({{ conc|tojson }}).length;
            renderPagConc({{ conc|tojson }}, pageValue, link);
        };
    </script>

    {% endif %}
{% endblock %}
